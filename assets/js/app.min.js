const myModule = (() => {
  "use strict";
  let e = [],
    t = [];
  const n = ["C", "D", "H", "S"],
    o = ["A", "J", "Q", "K"],
    l = (n = 2) => {
      (e = r()), (t = []);
      for (let e = 0; e < n; e++) t.push(0);
      d.forEach((e) => {
        e.innerText = 0;
      }),
        c.forEach((e) => {
          e.innerHTML = "";
        }),
        (s.disabled = !1),
        (i.disabled = !1);
    },
    r = () => {
      e = [];
      for (let t = 2; t <= 10; t++) for (let o of n) e.push(t + o);
      for (let t of n) for (let n of o) e.push(n + t);
      return _.shuffle(e);
    },
    a = () => {
      if (0 === e.length) throw " No hay mas cartas en el  deck ";
      return e.pop();
    },
    s = document.querySelector("#btnGetCard"),
    d = document.querySelectorAll("small"),
    c = document.querySelectorAll(".divCards"),
    i = document.querySelector("#btnStop"),
    u = document.querySelector("#btnNewGame");
  s.addEventListener("click", () => {
    const e = a(),
      t = m(e, 0);
    h(e, 0),
      t > 21
        ? (console.log("Lo siento perdiste, intentalo de nuevo"),
          (s.disabled = !0),
          (i.disabled = !0),
          b(t))
        : 21 === t &&
          (console.warn("21, Genial bien echo "),
          (s.disabled = !0),
          (i.disabled = !0),
          b(t));
  });
  const m = (e, n) => (
      (t[n] =
        t[n] +
        ((e) => {
          const t = e.substring(0, e.length - 1);
          return isNaN(t) ? ("A" === t ? 11 : 10) : 1 * t;
        })(e)),
      (d[n].innerText = t[n]),
      t[n]
    ),
    h = (e, t) => {
      const n = document.createElement("img");
      (n.src = `./cartas/${e}.png`), n.classList.add("cards"), c[t].append(n);
    },
    b = (e) => {
      let n = 0;
      do {
        const e = a();
        (n = m(e, t.length - 1)), h(e, t.length - 1);
      } while (n < e && e <= 21);
      (() => {
        const [e, n] = t;
        setTimeout(() => {
          e === n
            ? alert("Nadie Gano")
            : n > 21
            ? alert("Felictaciones Ganaste")
            : e > 21
            ? alert("Lo siento perdiste, intentalo de nuevo")
            : alert("Computadora Gana");
        }, 100);
      })();
    };
  return (
    i.addEventListener("click", () => {
      (s.disabled = !0), (i.disabled = !0), b(t[0]);
    }),
    u.addEventListener("click", () => {
      console.clear(), l();
    }),
    { newGame: l }
  );
})();
